window.__require=function e(t,n,o){function i(c,r){if(!n[c]){if(!t[c]){var s=c.split("/");if(s=s[s.length-1],!t[s]){var h="function"==typeof __require&&__require;if(!r&&h)return h(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+c+"'")}}var d=n[c]={exports:{}};t[c][0].call(d.exports,function(e){return i(t[c][1][e]||e)},d,d.exports,e,t,n,o)}return n[c].exports}for(var a="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({androidSdk:[function(e,t,n){"use strict";cc._RF.push(t,"a12c2J3yKlDMpQQLprOdAvn","androidSdk"),cc._RF.pop()},{}],branchmag1:[function(e,t,n){"use strict";cc._RF.push(t,"c8b88ku6A9MKLMYPBj3vbiN","branchmag1"),cc.Class({extends:cc.Component,properties:{branchpreL:{default:null,type:cc.Prefab},branchpreR:{default:null,type:cc.Prefab}},onLoad:function(){this.poolL=new cc.NodePool("branch"),this.poolR=new cc.NodePool("branch");for(var e=0;e<100;e++)this.poolL.put(cc.instantiate(this.branchpreL)),this.poolR.put(cc.instantiate(this.branchpreR))},start:function(){this.schedule(function(){!this.node.parent.getComponent("play").isGameOver&&this.poolL.size()>0&&this.poolR.size()>0&&this.node.parent.getComponent("play").createBranch(this.node,this.poolL,this.poolR)},.5)},update:function(e){this.node.parent.getComponent("play").isGameOver&&this.node.parent.getComponent("play").offTouch(this.node),this.node.parent.getComponent("play").isGameOver||this.node.parent.getComponent("play").touchStar(this.node)}}),cc._RF.pop()},{}],branchmag2:[function(e,t,n){"use strict";cc._RF.push(t,"5df48gaA05NIoo/J4tNrUuV","branchmag2"),cc.Class({extends:cc.Component,properties:{branchpreL:{default:null,type:cc.Prefab},branchpreR:{default:null,type:cc.Prefab}},onLoad:function(){this.poolL=new cc.NodePool("branch"),this.poolR=new cc.NodePool("branch");for(var e=0;e<100;e++)this.poolL.put(cc.instantiate(this.branchpreL)),this.poolR.put(cc.instantiate(this.branchpreR))},start:function(){this.schedule(function(){!this.node.parent.getComponent("play").isGameOver&&this.poolL.size()>0&&this.poolR.size()>0&&this.node.parent.getComponent("play").createBranch(this.node,this.poolL,this.poolR)},.5)},update:function(e){this.node.parent.getComponent("play").isGameOver&&this.node.parent.getComponent("play").offTouch(this.node),this.node.parent.getComponent("play").isGameOver||this.node.parent.getComponent("play").touchStar(this.node)}}),cc._RF.pop()},{}],branch:[function(e,t,n){"use strict";cc._RF.push(t,"64105DfwEZEbJLpmYqDWmzD","branch"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},init:function(e){this.pool=e},start:function(){},update:function(e){var t=cc.find("Canvas").getComponent("play").score/10>10?10:cc.find("Canvas").getComponent("play").score/10;(this.node.y<-this.node.height||cc.find("Canvas").getComponent("play").isGameOver)&&(cc.find("Canvas").getComponent("play").isGameOver||(cc.find("Canvas").getComponent("play").score+=.5,cc.find("Canvas").getChildByName("score").getComponent(cc.Label).string=parseInt(cc.find("Canvas").getComponent("play").score)),this.pool.put(this.node)),this.node.y-=5+t}}),cc._RF.pop()},{}],data:[function(e,t,n){"use strict";cc._RF.push(t,"a57712V5ZZJn4+503/e4AI1","data");t.exports={data:{userInfo:null,page:1}},cc._RF.pop()},{}],lead:[function(e,t,n){"use strict";cc._RF.push(t,"3e20do9TxFPjrEMXWK/sW/2","lead"),cc.Class({extends:cc.Component,properties:{},onCollisionEnter:function(e,t){cc.find("Canvas").getComponent("play").countDown()},onLoad:function(){this.speed=-1},start:function(){},update:function(e){this.node.x>=0&&this.node.x<=this.node.parent.width-this.node.width&&(this.node.x+=(10+cc.find("Canvas").getComponent("play").score)*this.speed),this.node.x<0&&(this.node.x=0),this.node.x>this.node.parent.width-this.node.width&&(this.node.x=this.node.parent.width-this.node.width),cc.find("Canvas").getComponent("play").isGameOver&&(this.node.x=0,this.speed=-1)}}),cc._RF.pop()},{}],play:[function(e,t,n){"use strict";cc._RF.push(t,"65f57bZhO1ESZsGHmmKX+OK","play");var o=e("./data.js");cc.Class({extends:cc.Component,properties:{ranking:{default:null,type:cc.Prefab}},onLoad:function(){var e=this;ZMIM.request("/login").then(function(e){console.log("login",e),0==e.state?ZMIM.config(e.data).then(function(e){ZMIM.showTips("config")}).catch(function(e){window.location.replace("https://dev.imapi.zhenmanapp.com/static/html/ivcode.html?code=#/")}):ZMIM.showTips("\u8bf7\u68c0\u67e5\u60a8\u7684\u7f51\u7edc")}).catch(function(){window.location.replace("https://dev.imapi.zhenmanapp.com/static/html/ivcode.html?code=#/")}),ZMIM.ready(function(){e.getLocalUserInfo(),ZMIM.showJOJOAlert("ready \u9875\u9762\u521d\u59cb\u5316\u6210\u529f").then(function(e){console.log("\u70b9\u63a5\u786e\u5b9a",e)})}),this.isGameOver=!0,cc.director.getCollisionManager().enabled=!0},getLocalUserInfo:function(){var e=this;ZMIM.getUserInfo().then(function(t){void 0!=t.lpsNoApp?e.node.getChildByName("WebView").active=!0:o.data.userInfo=t})},createBranch:function(e,t,n){var o=Math.floor(2*Math.random()),i=50+Math.floor(Math.random()*(cc.winSize.width/2-50)),a=null,c=0;1==o?((a=n.get()).getComponent("branch").init(n),c=e.width):(a=t.get()).getComponent("branch").init(t),a.width=i>cc.winSize.width/2-50?cc.winSize.width/2-50:i;var r=a.getComponent(cc.BoxCollider);r.size.width=a.width,r.size.height=a.height,r.offset=1==o?cc.v2(-a.width/2,a.height/2):cc.v2(a.width/2,a.height/2),a.x=c,a.y=cc.winSize.height+cc.winSize.height/2*Math.random()+30,e.childrenCount>1&&(a.y=e.children[e.childrenCount-1].y+a.height+cc.winSize.height/4+Math.random()*(200-this.score)),a.zIndex=1,e.addChild(a)},touchStar:function(e){var t=e.getChildByName("lead");e.on("touchstart",function(){t.getComponent("lead").speed=1},e,!0),e.on("touchend",function(){t.getComponent("lead").speed=-1},e,!0),e.on("touchcancel",function(){t.getComponent("lead").speed=-1},e,!0)},offTouch:function(e){e.getChildByName("lead");e.off("touchstart"),e.off("touchend")},countDown:function(){var e=5,t=this;t.isGameOver=!0,t.node.getChildByName("countDown").active=!0,t.node.getChildByName("countDown").getChildByName("hint").getComponent(cc.Label).string="\u662f\u5426\u6d88\u8017\u8304\u5b50\u590d\u6d3b\uff1f",t.node.getChildByName("countDown").getChildByName("time").getComponent(cc.Label).string=e;t.timmer=setInterval(function(){cc.log(e),0==e?(clearInterval(t.timmer),t.timmer=null,t.gameover()):(e-=1,t.node.getChildByName("countDown").getChildByName("time").getComponent(cc.Label).string=e)},1e3)},keepOn:function(){clearInterval(this.timmer);var e=this;e.timmer=null,e.node.getChildByName("countDown").active=!1,ZMIM.gameResurrection().then(function(t){cc.log("\u7eed\u547d\u56de\u8c03",t),0==t.code&&(0==t.data?(cc.log("\u7eed\u547d\u6210\u529f"),e.isGameOver=!1):(ZMIM.gameResetResurrection(),e.node.getChildByName("pop").active=!0))}).catch(function(e){console.log("err",e)})},showShareAlert:function(){var e=this;e.node.getChildByName("pop").active=!1,ZMIM.showShareAlert().then(function(t){e.gameover()})},gameStart:function(){this.isGameOver=!1,this.score=0,this.node.getChildByName("score").getComponent(cc.Label).string=this.score,this.node.getChildByName("index").active=!1},gameover:function(){this.timmer&&(clearInterval(this.timmer),this.timmer=null),this.node.getChildByName("pop").active=!1,ZMIM.gameResetResurrection(),ZMIM.saveGameScore(parseInt(this.score)),this.node.getChildByName("countDown").active=!1,this.node.getChildByName("index").active=!0,this.node.getChildByName("index").getChildByName("score").getComponent(cc.Label).string=this.node.getChildByName("score").getComponent(cc.Label).string},openRank:function(){cc.log("node",this.node.children),this.node.getChildByName("rankinglist").active=!0},closeRank:function(){this.node.getChildByName("rankinglist").active=!1},start:function(){this.node.addChild(cc.instantiate(this.ranking))},update:function(e){}}),cc._RF.pop()},{"./data.js":"data"}],ranking:[function(e,t,n){"use strict";cc._RF.push(t,"22d75u8i1xFrJHU3UzxXEub","ranking");var o=e("./data.js"),i=!1;cc.Class({extends:cc.Component,properties:{title:{default:null,type:cc.Node},content:{default:null,type:cc.Node},rowPre:{default:null,type:cc.Prefab},showType:""},onLoad:function(){this.showType="friend",this.rowPool=new cc.NodePool;for(var e=0;e<1;e++){var t=cc.instantiate(this.rowPre);this.rowPool.put(t)}},start:function(){},updateList:function(e,t){o.data.page=1,this.recycle(),this.content.removeAllChildren(),this.content.destroyAllChildren(),this.showType=t,this.title.getChildByName("friend").color="friend"==t?cc.Color.RED:cc.Color.WHITE,this.title.getChildByName("team").color="team"==t?cc.Color.RED:cc.Color.WHITE,this.title.getChildByName("world").color="world"==t?cc.Color.RED:cc.Color.WHITE,i||(i=!0,this.getList())},creatRow:function(e,t,n){var o=void 0;(o=this.rowPool.size()>0?this.rowPool.get():cc.instantiate(this.rowPre)).getChildByName("rank").getComponent(cc.Label).string=e,o.getChildByName("name").getComponent(cc.Label).string=t,o.getChildByName("score").getComponent(cc.Label).string=n,this.content.addChild(o)},updataMy:function(e,t,n){this.node.getChildByName("my").getChildByName("rank").getComponent(cc.Label).string=e,this.node.getChildByName("my").getChildByName("name").getComponent(cc.Label).string=t,this.node.getChildByName("my").getChildByName("score").getComponent(cc.Label).string=n,i=!1},getList:function(){var e=this;console.log("\u83b7\u53d6\u5217\u8868",this.showType,o.data.page),o.data.page=1,this.count=7,this.node.getChildByName("list").on("bounce-bottom",this.getCharts,this),"world"==this.showType&&ZMIM.getWorldRanking(o.data.page,7).then(function(t){e.addRankingOnly(t)},this),"team"==this.showType&&ZMIM.getTeamRanking(o.data.page,7).then(function(t){e.addRankingOnly(t)},this),"friend"==this.showType&&ZMIM.getFriendRanking(o.data.page,7).then(function(t){e.addRankingOnly(t)},this)},addRankingOnly:function(e){if(0==e.code){ZMIM.showTips(this.showType+" success"),e=e.data;for(var t=0;t<e.list.length;t++)this.creatRow(t+1,e.list[t].user.name,e.list[t].score);cc.find("Canvas").getChildByName("rankinglist").getChildByName("list").getComponent(cc.ScrollView).scrollToTop(),this.updataMy(e.my.row,o.data.userInfo.name,e.my.score)}},getCharts:function(){var e=this;o.data.page=o.data.page+1,"world"==this.showType&&ZMIM.getWorldRanking(o.data.page,7).then(function(t){e.addRanking(t)}),"team"==this.showType&&ZMIM.getTeamRanking(o.data.page,7).then(function(t){e.addRanking(t)}),"friend"==this.showType&&ZMIM.getFriendRanking(o.data.page,7).then(function(t){e.addRanking(t)},this)},addRanking:function(e){if(0==e.code&&(cc.log(this.showType+" ranking success"),(e=e.data).list.length>0)){this.count=7+this.list.length;for(var t=0;t<e.list.length;t++)self.creatRow(this.count+t,e.list[t].user.name,e.list[t].score);cc.find("Canvas/rankinglist").getComponent(cc.ScrollView).scrollToTop()}},onEnable:function(){o.data.page=1,this.updateList("","friend")},recycle:function(){for(;this.content.childrenCount>0;)this.rowPool.put(this.content.getChildByName("row"))},onDisable:function(){o.data.page=1,this.recycle(),this.content.removeAllChildren(),this.content.destroyAllChildren()},closeNode:function(){this.node.parent.getComponent("play").closeRank()}}),cc._RF.pop()},{"./data.js":"data"}],tensApi:[function(e,t,n){"use strict";cc._RF.push(t,"31554/U+tNNWrewFQ2ruZ1w","tensApi"),function(e,t){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return t(e)}):t(e,!0)}(window,function(e,t){function n(e,t,n,o){DAWebViewJavascriptBridge.callHandler(e,t,n,o)}function o(e,t){DAWebViewJavascriptBridge.callHandler(e,t)}var i;i={config:function(e){return new Promise(function(t,o){n("ZIMConfigPlugin","config",e,function(e,n){0===e?t(n):o(n)})})},ready:function(t){e.DAWebViewJavascriptBridge?(DAWebViewJavascriptBridge.init(function(e,t){t({"Javascript Responds":"Wee!"})}),t()):document.addEventListener("WebViewJavascriptBridgeReady",function(){DAWebViewJavascriptBridge.init(function(e,t){t({"Javascript Responds":"Wee!"})}),t()},!1)},error:function(e){},request:function(e,t,o){return new Promise(function(i,a){var c={};c.url=e,c.method=t,c.data=o,n("ZIMRequestPlugin","request",c,function(e,t){cc.log("state",e),cc.log("data",t),0===e?i(t):a(t)})})},getUserInfo:function(){return new Promise(function(e,t){n("ZIMUserInfoPlugin","getUserInfo",function(n,o){0===n?e(o):t(o)})})},showShareAlert:function(){return new Promise(function(e,t){n("ZIMShareAlertPlugin","showShareAlertView",function(n,o){0===n?e(o):t(o)})})},gameResurrection:function(e){return new Promise(function(t,o){n("ZIMGoldPlugin","gameResurrection",{id:e},function(e,n){0===e?t(n):o(n)})})},gameResetResurrection:function(){return new Promise(function(e,t){n("ZIMGoldPlugin","gameResetResurrection",function(n,o){0===n?e(o):t(o)})})},getWorldRanking:function(e,t){return new Promise(function(o,i){n("ZIMRankingPlugin","getWorldRanking",{page:e,count:t},function(e,t){0===e?o(t):i(t)})})},getTeamRanking:function(e,t){return new Promise(function(o,i){n("ZIMRankingPlugin","getTeamRanking",{page:e,count:t},function(e,t){console.log("state",e,t),0===e?o(t):i(t)})})},getFriendRanking:function(e,t){return new Promise(function(o,i){n("ZIMRankingPlugin","getFriendRanking",{page:e,count:t},function(e,t){0===e?o(t):i(t)})})},saveGameScore:function(e){return new Promise(function(t,o){n("ZIMRankingPlugin","saveGameScore",{score:e},function(e,n){0===e?t(n):o(n)})})},showTips:function(e){return new Promise(function(t,o){n("ZIMShareAlertPlugin","showTips",{message:e},function(e,n){0===e?t(n):o(n)})})},showJOJOAlert:function(e){return new Promise(function(t,o){n("ZIMShareAlertPlugin","showJOJOAlert",{message:e},function(e,n){0===e?t(n):o(n)})})},currentScreenState:function(e){return new Promise(function(e,t){o("currentScreenState",function(t,n){e(n)})})}},t&&(e.zmim=e.ZMIM=i)}),cc._RF.pop()},{}]},{},["androidSdk","branch","branchmag1","branchmag2","data","lead","play","ranking","tensApi"]);
//# sourceMappingURL=project.js.map